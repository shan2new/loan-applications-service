commands:
  01_install_aws_cli:
    command: |
      yum -y install aws-cli
    ignoreErrors: true

container_commands:
  01_ensure_permissions:
    command: |
      chmod +x /opt/elasticbeanstalk/hooks/appdeploy/pre/01_set_env_vars.sh
    ignoreErrors: true

  02_copy_env_file:
    command: |
      # This runs after the application has been deployed but before it's started
      if [ -f /opt/elasticbeanstalk/deployment/app/staging/.env ]; then
        cp -f /opt/elasticbeanstalk/deployment/app/staging/.env /var/app/current/.env
        echo "Copied .env file to application directory"
      else
        echo "WARNING: .env file does not exist in staging directory"
      fi
    leader_only: true
    ignoreErrors: false
